<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;script&gt;</p>
<p class="p1">// ğŸ‘‰ Incolla qui l'URL della tua Web App (termina con /exec)</p>
<p class="p1">const SCRIPT_URL = ""; // es: "https://script.google.com/macros/s/AKfycbx.../exec"</p>
<p class="p2"><br></p>
<p class="p1">// Profili singoli</p>
<p class="p1">const FISH = {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Pesce Gatto": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "PESCE GATTO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "A TE PROPI UN PASGÃ€T! A volte un pÃ² superficiale e distratto, prendi la vita con leggerezza. Non ti fai troppi problemi, e spesso sei quello che riesce a strappare una risata agli altri con la tua spontaneitÃ . Sei frivolo, allegro, capace di divertirti anche nelle situazioni piÃ¹ banali. E alla fine, tutti ti vogliono bene perchÃ© porti leggerezza ovunque. Bravo Pesce Gatto: ti sei guadagnato lâ€™adesivo speciale, vieni a ritirarlo al banchetto della Risalita dei pesci!"</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Siluro": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "SILURO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Sei un SILURO, il gigante del fiume! Forte, energico e deciso, quando entri in una situazione non passi inosservato. Sei un leader naturale, ami prendere in mano le cose e non hai paura di buttarti nelle sfide piÃ¹ impegnative. Attento perÃ² a non occupare troppo spazio: a volte la tua potenza puÃ² mettere in ombra gli altri. Ma nel complesso, sei carisma puro."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Storione": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "STORIONE",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Sei uno STORIONE, antico e saggio. Hai memoria, profonditÃ  e spesso sei il punto di riferimento per chi ti sta vicino. Non corri dietro alle mode, preferisci la stabilitÃ  e la tradizione, e gli amici ti vedono come una persona affidabile, che dÃ  sicurezza. Forse non sei il piÃ¹ rumoroso del gruppo, ma quando parli, lasci il segno."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Carpa": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "CARPA",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Sei una CARPA: tranquillo, socievole, un amico vero. Ti piace la serenitÃ , non ami i conflitti e sei quello che riesce sempre a riportare lâ€™armonia nel gruppo. Non hai bisogno di stare al centro dellâ€™attenzione, preferisci circondarti di persone con cui ti senti bene. Sei il collante che tiene unito il branco: affidabile, dolce e sempre disponibile."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Anguilla": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "ANGUILLA",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Sei unâ€™ANGUILLA: misterioso, creativo, imprevedibile. Gli altri non sanno mai cosa aspettarsi da te, e questo ti rende affascinante. Ami uscire dagli schemi, sorprendere con idee diverse e a volte sembri quasi inafferrabile. Non ti piace essere imbrigliato: sei libero e indipendente, e chi ti conosce non si annoia mai."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// Profili MIX (paritÃ  a 2) â€” discorsivi e completi</p>
<p class="p1">const TIE_RESULTS = {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Anguilla|Carpa": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: ANGUILLA + CARPA",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Sei un connettore creativo. Hai il gusto dellâ€™imprevisto ma senza perdere la gentilezza: cerchi lâ€™armonia nel gruppo e allo stesso tempo sparigli con idee originali che fanno sorridere e riflettere. Con te le persone si sentono a proprio agio, perchÃ© riesci a combinare empatia e fantasia: sai coinvolgere, proporre alternative e trasformare un incontro normale in qualcosa di speciale."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Anguilla|Pesce Gatto": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: ANGUILLA + PESCE GATTO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Ironia e immaginazione ti vengono naturali. Prendi la vita con leggerezza ma non per questo sei superficiale: la tua creativitÃ  spunta dove gli altri vedono routine, e spesso sei tu a cambiare lâ€™umore di una stanza con una battuta o unâ€™idea fuori dal coro. Spontaneo, versatile, sorprendi senza fare rumore e lasci dietro di te buonumore e curiositÃ ."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Anguilla|Siluro": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: ANGUILLA + SILURO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Visione e azione: sogni soluzioni diverse e poi trovi il modo di farle accadere davvero. Hai il coraggio di osare e la fantasia per tracciare strade nuove. Guida naturale, ma mai scontata: la tua energia Ã¨ magnetica e inviti gli altri a buttarsi in esperienze che raccontano chi sei, con una scintilla di sana follia."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Anguilla|Storione": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: ANGUILLA + STORIONE",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Originale con profonditÃ . Ami esplorare strade non battute, ma lo fai con giudizio e memoria. Sai dare un senso alle novitÃ , collegandole a ciÃ² che conta davvero. Le persone si fidano di te perchÃ© unisci creativitÃ  e saggezza: non cerchi solo lâ€™effetto wow, ma un significato che resti."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Carpa|Pesce Gatto": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: CARPA + PESCE GATTO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Il tuo superpotere Ã¨ portare leggerezza nelle relazioni. Fai gruppo, smorzi i conflitti e ricordi agli altri che si puÃ² stare bene anche nelle piccole cose. Sei accogliente e scanzonato al punto giusto: con te, ogni cena ha il suo momento di risate sincere e feeling vero."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Carpa|Siluro": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: CARPA + SILURO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Guida e ascolto: sai tenere il timone senza perdere di vista chi hai accanto. Pratico, deciso, ma capace di creare unitÃ : trasformi gli obiettivi in azione e ti assicuri che tutti si sentano parte del viaggio. Il risultato? Una spinta in avanti che non schiaccia nessuno."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Carpa|Storione": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: CARPA + STORIONE",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "StabilitÃ  che rassicura. Dai valore a tradizioni, memoria e qualitÃ  del tempo insieme. Quando câ€™Ã¨ bisogno di equilibrio, sei il punto fermo: ascolti, organizzi, riporti calma. Le persone ti cercano perchÃ© con te ritrovano serenitÃ  e chiarezza, senza bisogno di grandi effetti speciali."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Pesce Gatto|Siluro": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: PESCE GATTO + SILURO",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Carisma con sorriso. Ti butti nelle cose e trascini gli altri, ma con quella ironia che rende tutto piÃ¹ leggero. Sei energia che unisce: sai alleggerire la tensione, motivare e accendere lâ€™entusiasmo del gruppo. Impossibile non seguirti â€” e divertirsi."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Pesce Gatto|Storione": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: PESCE GATTO + STORIONE",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Leggerezza consapevole. Sai quando scherzare e quando andare a fondo: alterni momenti ironici a riflessioni che restano. Stai bene nelle tradizioni, ma ci metti il tuo tocco brillante. Il risultato Ã¨ un equilibrio unico tra profonditÃ  e spontaneitÃ ."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>"Siluro|Storione": {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title: "Mix: SILURO + STORIONE",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text: "Decisione con visione lunga. Prendi in mano le situazioni con fermezza e responsabilitÃ , ragionando sul quadro dâ€™insieme. Affidabile e autorevole, ispiri fiducia perchÃ© unisci coraggio e prudenza: sai accelerare quando serve, ma con una rotta chiara."</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">};</p>
<p class="p1">function tieKey(a,b){ return [a,b].sort().join("|"); }</p>
<p class="p2"><br></p>
<p class="p1">// Domande e opzioni (il mapping al pesce sta nel value, non visibile)</p>
<p class="p1">const QUESTIONS = [</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 1: Sei a una cena con amici. Ti servono un piatto che non conosci..",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Lo assaggio senza sapere cosâ€™Ã¨, tantoâ€¦ che sarÃ  mai!", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Voglio capire bene cosa câ€™Ã¨ dentro prima di provarlo", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Lo condivido con tutti, cosÃ¬ Ã¨ piÃ¹ divertente", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Ne mangio un poâ€™, poi mi invento una scusa strana", "Anguilla"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Mi butto e lo mangio tutto senza pensarci due volte", "Siluro"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 2: Se il tuo weekend fosse un film, che genere sarebbe?",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Commedia stile una notte da leoni, dove il giorno dopo non ti ricordi piÃ¹ nulla", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Saltare da un palazzo in fiamme con una mustang? Ogni weekend", "Siluro"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Un bel film storico sul divano, camino acceso", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Commedia comica, un tavolo, piatti di ogni genere e risate a non finire", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Mistero e incontri sovrannaturali", "Anguilla"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 3: Se fossi un drink, quale saresti?",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Un gin tonic come si deve", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Un vino rosso corposo", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Una cochina ghiaccio e limone", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Un cocktail inedito, improvvisato al momento", "Anguilla"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Un Negroni o uno Sbagliato", "Siluro"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 4: In un gruppo di lavoro tu sei quello cheâ€¦",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Dice \"ci pensiamo domani\" e intanto scrolla i reel su instagram", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Mette ordine e tiene memoria di tutto", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Tiene unito il gruppo e smorza i conflitti", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Trova la soluzione piÃ¹ bizzarra, ma che funziona", "Anguilla"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Prende in mano la situazione e decide", "Siluro"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 5: Sei in viaggio e ti perdi. Cosa fai?",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Scatto un selfie instagrammabile e me la rido", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Controllo la mappa e cerco di ritornare sui miei passi", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Chiedo indicazioni con calma a qualcuno", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Vado a caso, convinto che sia unâ€™avventura", "Anguilla"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Seguo lâ€™istinto e cammino dritto fino a destinazione", "Siluro"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 6: In una cena con amici, tu sei quello cheâ€¦",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Commenta ironicamente dietro le quinte come la Giallapa's Band", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Racconta vecchi aneddoti e fa riflettere tutti", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Fa partire i brindisi e mette dâ€™accordo tutti", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Sparisce unâ€™ora e poi ricompare con una storia assurda", "Anguilla"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Tiene banco raccontando storie e battute", "Siluro"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{ q: "Domanda 7: Ti propongono un viaggio last-minute. Come reagisci?",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>options: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Accetto solo se il viaggio Ã¨ offerto", "Pesce Gatto"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Parto solo se câ€™Ã¨ un programma chiaro e definito", "Storione"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Chiamo gli amici e organizziamo in gruppo", "Carpa"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Scelgo le esperienze piÃ¹ strane da fare", "Anguilla"],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>["Mi gaso, sarÃ  unâ€™avventura piena di adrenalina", "Siluro"]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>]}</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">// ---- DOM refs</p>
<p class="p1">const form = document.getElementById('quiz-form');</p>
<p class="p1">const qWrap = document.getElementById('questions-wrap');</p>
<p class="p1">const progress = document.getElementById('progress-bar');</p>
<p class="p1">const resultEl = document.getElementById('result');</p>
<p class="p1">const badgesEl = document.getElementById('result-badges');</p>
<p class="p1">const titleEl = document.getElementById('result-title');</p>
<p class="p1">const textEl = document.getElementById('result-text');</p>
<p class="p1">const btnSubmit = document.getElementById('btn-submit');</p>
<p class="p1">const btnReset = document.getElementById('btn-reset');</p>
<p class="p1">const btnAgain = document.getElementById('btn-again');</p>
<p class="p1">const btnCopy = document.getElementById('btn-copy');</p>
<p class="p1">const btnShare = document.getElementById('btn-share');</p>
<p class="p2"><br></p>
<p class="p1">// ---- Render delle domande (mapping nascosto)</p>
<p class="p1">function renderQuestions(){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let html = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>QUESTIONS.forEach((item, idx) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const qId = `q${idx+1}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>html += `&lt;fieldset class="q"&gt;&lt;legend class="hidden"&gt;Domanda ${idx+1}&lt;/legend&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>html += `&lt;h3&gt;${item.q}&lt;/h3&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>html += `&lt;div class="options" role="radiogroup" aria-labelledby="${qId}-label"&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>item.options.forEach((op, oi) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const id = `${qId}-opt${oi+1}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>html += `&lt;label class="option" for="${id}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="radio" name="${qId}" id="${id}" value="${op[1]}" required /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;span&gt;${op[0]}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/label&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>html += `&lt;/div&gt;&lt;/fieldset&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>qWrap.innerHTML = html;</p>
<p class="p1">}</p>
<p class="p1">renderQuestions();</p>
<p class="p2"><br></p>
<p class="p1">// ---- Progress bar</p>
<p class="p1">function updateProgress(){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const total = QUESTIONS.length + 2;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let count = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const data = new FormData(form);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(data.get('nomeCognome')) count++;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(data.get('cittaProvincia')) count++;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>for(let i=1;i&lt;=QUESTIONS.length;i++){ if(data.get('q'+i)) count++; }</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>progress.style.width = Math.round(count/total*100) + '%';</p>
<p class="p1">}</p>
<p class="p1">form.addEventListener('input', updateProgress);</p>
<p class="p1">updateProgress();</p>
<p class="p2"><br></p>
<p class="p1">// ---- Calcolo risultato</p>
<p class="p1">function computeResult(){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const data = new FormData(form);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const scores = {"Pesce Gatto":0,"Siluro":0,"Storione":0,"Carpa":0,"Anguilla":0};</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const missing = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(!data.get('nomeCognome')) missing.push("Nome e Cognome");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(!data.get('cittaProvincia')) missing.push("CittÃ  e Provincia");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>QUESTIONS.forEach((_, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const key = `q${i+1}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const val = data.get(key);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if(!val){ missing.push("Domanda " + (i+1)); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>else { scores[val]++; }</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(missing.length){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>alert("Compila tutti i campi (mancano: " + missing.join(", ") + ").");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return null;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const max = Math.max(...Object.values(scores));</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const winners = Object.entries(scores).filter(([k,v]) =&gt; v === max).map(([k]) =&gt; k);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>return {data, scores, winners};</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// ---- Invio silenzioso a Google Sheets (nessuna UI di notifica)</p>
<p class="p1">async function sendToSheet(payload){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(!SCRIPT_URL) return; // se non impostato, non fa nulla</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>try{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>await fetch(SCRIPT_URL, {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>method:"POST",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>headers:{ "Content-Type":"application/json" },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>body: JSON.stringify(payload),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>keepalive: true</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}catch(e){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// Silenzioso: nessun alert per l'utente finale</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>console.warn("Invio Sheet fallito:", e);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// ---- Costruzione testo risultato (singolo / paritÃ  2 / paritÃ  3+)</p>
<p class="p1">function showResult(winners){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let title, text, badgesHtml;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (winners.length === 1) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const w = winners[0];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title = "Risultato: " + FISH[w].title;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text<span class="Apple-converted-space">Â  </span>= FISH[w].text;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>badgesHtml = `&lt;span class="badge"&gt;ğŸ… ${FISH[w].title}&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} else if (winners.length === 2) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const key = tieKey(winners[0], winners[1]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const tie = TIE_RESULTS[key];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (tie) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>title = tie.title;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text<span class="Apple-converted-space">Â  </span>= tie.text;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>title = "Risultato: Mix " + winners.join(" + ");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text<span class="Apple-converted-space">Â  </span>= "ParitÃ  perfetta tra stili diversi: unisci qualitÃ  complementari e ti adatti alle situazioni con naturalezza.";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>badgesHtml = winners.map(w =&gt; `&lt;span class="badge"&gt;ğŸ… ${FISH[w].title}&lt;/span&gt;`).join(" ");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// ParitÃ  tra 3 o piÃ¹ pesci</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const elenco = winners.map(w =&gt; FISH[w].title).join(", ");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title = "Risultato: Mix bilanciato";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>text<span class="Apple-converted-space">Â  </span>= "In te convivono piÃ¹ energie: " + elenco + ". Hai un profilo versatile e sfaccettato: sai quando spingere, quando ascoltare, quando alleggerire e quando sorprendere. Il tuo equilibrio Ã¨ la tua forza.";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>badgesHtml = winners.map(w =&gt; `&lt;span class="badge"&gt;ğŸ… ${FISH[w].title}&lt;/span&gt;`).join(" ");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>badgesEl.innerHTML = badgesHtml;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>titleEl.textContent = title;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>textEl.textContent<span class="Apple-converted-space">Â  </span>= text;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>resultEl.style.display = "block";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>resultEl.scrollIntoView({behavior:"smooth"});</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// ---- Handlers</p>
<p class="p1">btnSubmit.addEventListener('click', async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const r = computeResult(); if(!r) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// payload</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const name = r.data.get('nomeCognome').trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const city = r.data.get('cittaProvincia').trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const choices = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>for(let i=1;i&lt;=QUESTIONS.length;i++){ choices.push(r.data.get('q'+i)); }</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const payload = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>timestamp: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>name, city, choices, scores: r.scores, winners: r.winners,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>page: location.href, ua: navigator.userAgent</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// invio silenzioso</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>await sendToSheet(payload);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// mostra risultato</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>showResult(r.winners);</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">btnReset.addEventListener('click', ()=&gt;{ form.reset(); updateProgress(); resultEl.style.display="none"; });</p>
<p class="p1">btnAgain?.addEventListener('click', ()=&gt;{ form.reset(); updateProgress(); resultEl.style.display="none"; window.scrollTo({top:0, behavior:"smooth"}); });</p>
<p class="p2"><br></p>
<p class="p1">// Copy &amp; Share</p>
<p class="p1">btnCopy?.addEventListener('click', async ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const t = (titleEl.textContent||"") + "\n\n" + (textEl.textContent||"");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>try{ await navigator.clipboard.writeText(t); btnCopy.textContent="âœ… Copiato"; setTimeout(()=&gt;btnCopy.textContent="Copia risultato",1200); }catch{}</p>
<p class="p1">});</p>
<p class="p1">btnShare?.addEventListener('click', async ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const data = { title:"Quale pesce sei?", text:titleEl.textContent, url:location.href };</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(navigator.share){ try{ await navigator.share(data); }catch{} }</p>
<p class="p1">});</p>
<p class="p1">&lt;/script&gt;</p>
</body>
</html>
